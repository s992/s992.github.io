<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><title>Integrating SendGrid With Your ColdFusion Application - Sean Walsh</title><meta name=author content="Sean Walsh"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The majority of my day today was spent evaluating SendGrid and fiddling around with the API. For those of you unfamiliar with SendGrid, it&#x27;s a hosted ..."><link rel=icon href=/favicon.ico><link rel=apple-touch-icon sizes=57x57 href=/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon-180x180.png><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-194x194.png sizes=194x194><link rel=icon type=image/png href=/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content=#b91d47><meta name=msapplication-TileImage content=/mstile-144x144.png><meta name=theme-color content=#ffffff><link rel=stylesheet href=/assets/css/site.css><link rel=stylesheet href="http://fonts.googleapis.com/css?family=Slabo+27px|Roboto"><link rel=canonical href=http://swalsh.org/blog/2011/12/07/integrating-sendgrid-with-your-coldfusion-application><link rel=alternate title="Sean Walsh" type=application/rss+xml href=/rss.xml></head><body><header><nav class="navbar navbar-default"><div class=container-fluid><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#main-navbar-collapse aria-expanded=false><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href="http://swalsh.org/">Sean Walsh</a></div><div class="collapse navbar-collapse" id=main-navbar-collapse><ul class="nav navbar-nav"><li><a href=http://swalsh.org/blog>Blog</a></li><li><a href=http://swalsh.org/about>About</a></li></ul></div></div></nav></header><main class=container-fluid><div class=row><article class="col-md-8 col-lg-7 col-xl-5 center-block"><header><h1><a href=http://swalsh.org/blog/2011/12/07/integrating-sendgrid-with-your-coldfusion-application>Integrating SendGrid With Your ColdFusion Application</a></h1><p class=meta><time datetime="Wed Dec 07 2011 06:23:33 GMT-0800 (Pacific Standard Time)">7 Dec 2011</time></p></header><div class="content full-content"><p>The majority of my day today was spent evaluating <a href="http://sendgrid.com/">SendGrid</a> and fiddling around with the API. For those of you unfamiliar with SendGrid, it&#39;s a hosted e-mail delivery service. At the very (very!) basic level, they provide a mailserver that you can use for your application. Of course, it&#39;s much more than that - the reason I was looking into it today is because we need a solid e-mail provider for e-mail newsletters for our clients. Currently, we are using an incredibly outdated version of Lyris List Manager and it&#39;s right about time that we replace it. Now, SendGrid doesn&#39;t provide any list management, that will have to be done in the application. What I&#39;m about to show you is how to interface with SendGrid to send (potentially) copious amounts of e-mail very, very easily.</p><h3 id=getting-started>Getting Started</h3><p>Your first step is to sign up for an account. Luckily for us, SendGrid offers a free plan that allows you to send up to 200 e-mails per day - perfect for our testing environment! You can find the sign-up link at the very bottom of their <a href=http://sendgrid.com/pricing.html>product pricing page</a>. Once you sign up, it will take a few minutes before they get you up and running because they apparently verify each account by hand. I&#39;m not sure if this is actually true, but that&#39;s what they say.</p><p>Once you&#39;re set up, you can start using their service right away if you want. Just plug the SMTP settings into your mail client or CF application and you&#39;ll be eating away at those precious 200-daily e-mails. But we want to do something more interesting...</p><h3 id=the-fun-stuff>The Fun Stuff</h3><p>SendGrid will allow you to send mail in three ways - normal SMTP, the Web API, and the SMTP API. We&#39;re going to be using the Web API for this demonstration, but the SMTP API is very, very similar.</p><p>X-SMTPAPI is where the real fun stuff comes into play. It&#39;s a JSON-encoded associative array that is inserted as a custom header in the SMTP API and as a URL parameter in the Web API. The array can contain any of the following keys(pulled from the <a href="http://docs.sendgrid.com/documentation/api/smtp-api/developers-guide/">documentation</a>):</p><ul><li>&quot;to&quot; - An address or list of addresses for the message to be sent to.</li><li>&quot;sub&quot; - An associative array of substitution tags, where each tag is associated with a list of replacement text for the tag in the body text. Each Substitution value corresponds to an email in the “To” section of the JSON string. Yah, it&#39;s mail merge.</li><li>&quot;section&quot; - Sections can be used to simplify substitution values that are common to many recipients. This is an associative array of sections that can be used in substitution values.</li><li>&quot;category&quot; - Associates the category of email this should be logged as. You may insert up to 10 categories as an array, these categories are not predefined.</li><li>&quot;unique_args&quot; - An associative array of arguments and their values to be applied to all emails sent in this SMTP API transaction.</li><li>&quot;filter&quot; - An associative array of filters and their settings, used to override filter settings already setup for your account. Settings are an associative array of the setting names and their values.</li></ul><p>SendGrid offers a few examples of code to build this JSON string in Perl, PHP, Python, and Ruby. I&#39;m most familiar with PHP, so I went ahead and grabbed the <a href="http://docs.sendgrid.com/documentation/api/smtp-api/php-example/">PHP version</a> and started converting it. I ended up with the following code, which works fine in my testing but has not yet been tested in a production setting - so use it at your own risk!</p><script src="https://gist.github.com/1445942.js?file=smtpApiHeader.cfc"></script><p>Now that we have the hard stuff out of the way, I&#39;m going to put together a simple form and processing page that will take a comma delimited list of e-mail addresses and a comma delimited list of user names and then send out a batch e-mail via SendGrid&#39;s Web API.</p><script src="https://gist.github.com/1445942.js?file=index.cfm"></script><p>Yah, it&#39;s an ugly form but it gets what we need. So, onward! Time to process the data from this form, translate it into a JSON string, and then ship it off to SendGrid.</p><script src="https://gist.github.com/1445942.js?file=process.cfm"></script><p>As you can see, this is a really simple process and I&#39;ve only just begun to scratch the surface.</p><p>Once again - I need to stress that none of this has been tested in production, so use my code at your own risk! You can grab the full source on my Gist at <a href=https://gist.github.com/1445942>https://gist.github.com/1445942</a></p></div><footer><nav class=pagination><a href=http://swalsh.org/blog/2011/10/31/building-a-github-activity-feed class=pull-left>&laquo; Building a GitHub Activity Feed</a> <a href=http://swalsh.org/blog/2013/03/20/programmatically-creating-new-datasource-in-coldfusion class=pull-right>Programmatically Creating New Datasource in Coldfusion &raquo;</a></nav></footer></article></div><div class=row><div class="col-md-8 col-lg-7 col-xl-5 center-block"><h1>Comments</h1><div id=disqus_thread></div><script type=text/javascript>var disqus_shortname = "swalsh",
				disqus_identifier = "http://swalsh.org/blog/2011/12/07/integrating-sendgrid-with-your-coldfusion-application/"
				disqus_url = "http://swalsh.org/blog/2011/12/07/integrating-sendgrid-with-your-coldfusion-application/";
			
			(function() {
				var dsq = document.createElement('script'); 
				dsq.type = 'text/javascript'; 
				dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></main><footer id=site-footer class=container-fluid><ul class="nav nav-pills pull-right"><li><a target=_blank href=https://github.com/s992><i class="fa fa-github"></i></a></li><li><a target=_blank href=https://twitter.com/theseanwalsh><i class="fa fa-twitter"></i></a></li><li><a target=_blank href=http://stackoverflow.com/users/603502/sean-walsh><i class="fa fa-stack-overflow"></i></a></li><li><a target=_blank href=https://www.linkedin.com/pub/sean-walsh/bb/aa4/6a8><i class="fa fa-linkedin"></i></a></li></ul></footer><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-52344422-1', 'auto');
ga('send', 'pageview');</script></body></html>