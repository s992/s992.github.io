<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><title>npm as a Build System Can Be Slightly Annoying - Sean Walsh</title><meta name=author content="Sean Walsh"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I was originally going to title this article, &amp;quot;Why I Don&#x27;t Like npm as a Build System,&amp;quot; but I thought that sounded a little confrontational...."><link rel=icon href=/favicon.ico><link rel=apple-touch-icon sizes=57x57 href=/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon-180x180.png><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-194x194.png sizes=194x194><link rel=icon type=image/png href=/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content=#b91d47><meta name=msapplication-TileImage content=/mstile-144x144.png><meta name=theme-color content=#ffffff><link rel=stylesheet href=/assets/css/site.css><link rel=stylesheet href="http://fonts.googleapis.com/css?family=Slabo+27px|Roboto"><link rel=canonical href=http://swalsh.org/blog/2015/09/21/npm-as-a-build-system-can-be-slightly-annoying><link rel=alternate title="Sean Walsh" type=application/rss+xml href=/rss.xml></head><body><header><nav class="navbar navbar-default"><div class=container-fluid><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#main-navbar-collapse aria-expanded=false><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href="http://swalsh.org/">Sean Walsh</a></div><div class="collapse navbar-collapse" id=main-navbar-collapse><ul class="nav navbar-nav"><li><a href=http://swalsh.org/blog>Blog</a></li><li><a href=http://swalsh.org/about>About</a></li></ul></div></div></nav></header><main class=container-fluid><div class=row><article class="col-md-8 col-lg-7 col-xl-5 center-block"><header><h1><a href=http://swalsh.org/blog/2015/09/21/npm-as-a-build-system-can-be-slightly-annoying>npm as a Build System Can Be Slightly Annoying</a></h1><p class=meta><time datetime="Mon Sep 21 2015 11:30:00 GMT-0700 (Pacific Daylight Time)">21 Sep 2015</time></p></header><div class="content full-content"><p>I was originally going to title this article, &quot;Why I Don&#39;t Like npm as a Build System,&quot; but I thought that sounded a little confrontational. I actually like the <em>concept</em> of npm as a build system, but there&#39;s one thing that project maintainers frequently forget: their Windows users (<a href="https://www.youtube.com/watch?v=lKie-vgUGdI">there are dozens of us!</a>). This morning, I read a <a href="http://www.sitepoint.com/guide-to-npm-as-a-build-tool/">great article</a> on ditching your Grunt/Gulp/etc dependency and using npm as your build system via <a href=https://docs.npmjs.com/misc/scripts>npm scripts</a>. It reminded me of a slight annoyance I ran into earlier this year when looking into contributing to <a href=https://github.com/formly-js/angular-formly>angular-formly</a>.</p><p>Now, the first thing I want to say is that this is in no way meant to be an attack against angular-formly or its maintainer, the excellent <a href=https://twitter.com/kentcdodds>Kent C. Dodds</a> - I recommend angular-formly to anyone who will listen, and Kent is at the top of my &quot;awesome open source maintainers and also really cool people in general&quot; list (it&#39;s a very exclusive list). The only reason I&#39;m using angular-formly as an example is because it&#39;s the first project that popped into my mind when I read the blog post. Also, angular-formly has since been updated to resolve this problem. :)</p><p>That being said, I did run into a minor frustration when looking at making a contribution. I don&#39;t remember exactly what I was trying to do, but it probably had something to do with one of these issues: <a href=https://github.com/formly-js/angular-formly/issues/269>#269</a> or <a href=https://github.com/formly-js/angular-formly/issues/279>#279</a>. I made a change to my local copy of the project and, being a good coder, decided to run the tests before firing off an untested pull request. Easy enough, right? Just kick it off with: <code>npm run test</code>.</p><p>Wrong! Windows wasn&#39;t OK with that: <code>&#39;NODE_ENV&#39; is not recognized as an internal or external command, operable program, or batch file.</code></p><p>You see, a lot of projects that use npm as a build system will set the <code>NODE_ENV</code> environment variable before kicking off their scripts (which, by the way, is a perfectly reasonable thing to do). The problem is that the vast majority of project maintainers work on *nix systems and Windows tends to slip their minds. This is what the <code>npm test</code> command executed: <code>NODE_ENV=test karma start</code>. In Windows, it would have to be rewritten to <code>set NODE_ENV=test&amp;&amp;karma start</code>. That will work for cmd, anyway - Powershell is a completely different beast and I haven&#39;t actually figured out how to write a one-liner equivalent for Powershell.</p><p>So, what&#39;s the solution? Well, I hadn&#39;t seen the angular-formly repo since it had been fixed and I had been planning on trying to tackle the problem myself. Turns out another angular-formly user, <a href=https://github.com/benoror>benoror</a>, ran into the same thing I had and had decided to <a href=https://github.com/formly-js/angular-formly/pull/350>solve it</a>. A few days later, <a href=https://github.com/benoror/better-npm-run>better-npm-run</a> was born! It&#39;s a library that aims to solve the cross-platform compatibility issues with npm scripts. I ran through a few of angular-formly&#39;s npm scripts as I was writing this post and they all seem to work great.</p><p>As you can see from <a href=https://github.com/formly-js/angular-formly/commit/6fbaea258a1f3c5737f7d4276ad49c2a065988e3>the commit</a> that added better-npm-run to angular-formly, it is quite a bit more verbose than simple npm scripts. That&#39;s not too high a price to pay, though - as a project maintainer, the unfortunate alternative is potentially alienating Windows users who would love to help make your project better but choose not to because of the barrier to entry. It may be a very slight barrier, but I guarantee that some people who would have otherwise contributed to a project decided not to because they either</p><ol><li>Couldn&#39;t be bothered to figure out how to run the scripts in their environment, or</li><li>Didn&#39;t have the knowledge they needed to figure out how to run the scripts in their environment.</li></ol><p>I might be overly optimistic, but I&#39;d like to think that the majority of open source maintainers would like to be as open as possible to new contributors - regardless of their operating system. If you&#39;re one of those maintainers, I&#39;d encourage you to make sure your build and test scripts work on all platforms. If you don&#39;t have access to a Windows machine, I&#39;d be happy to clone your repo and run your scripts - just drop me a line.</p></div><footer><nav class=pagination><a href=http://swalsh.org/blog/2014/09/17/file-uploads-with-angularjs-and-ratpack-part-2 class=pull-left>&laquo; File Uploads with AngularJS and Ratpack: Part 2</a></nav></footer></article></div><div class=row><div class="col-md-8 col-lg-7 col-xl-5 center-block"><h1>Comments</h1><div id=disqus_thread></div><script type=text/javascript>var disqus_shortname = "swalsh",
				disqus_identifier = "http://swalsh.org/blog/2015/09/21/npm-as-a-build-system-can-be-slightly-annoying/"
				disqus_url = "http://swalsh.org/blog/2015/09/21/npm-as-a-build-system-can-be-slightly-annoying/";
			
			(function() {
				var dsq = document.createElement('script'); 
				dsq.type = 'text/javascript'; 
				dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></main><footer id=site-footer class=container-fluid><ul class="nav nav-pills pull-right"><li><a target=_blank href=https://github.com/s992><i class="fa fa-github"></i></a></li><li><a target=_blank href=https://twitter.com/theseanwalsh><i class="fa fa-twitter"></i></a></li><li><a target=_blank href=http://stackoverflow.com/users/603502/sean-walsh><i class="fa fa-stack-overflow"></i></a></li><li><a target=_blank href=https://www.linkedin.com/pub/sean-walsh/bb/aa4/6a8><i class="fa fa-linkedin"></i></a></li></ul></footer><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-52344422-1', 'auto');
ga('send', 'pageview');</script></body></html>